### Многофункциональный Telegram-бот

Этот проект представляет собой Telegram-бота, который может обрабатывать изображения, отправленные пользователем, и
выполнять с ними несколько операций: пикселизацию, преобразование в ASCII-арт, инверсию цветов, отражение по горизонтали
или вертикали, создание тепловой карты, а также изменение размера изображения для использования в качестве стикера. Бот
также может отправлять случайные шутки и комплименты, а также предоставлять список доступных команд.

## Содержание

- [Установка](#установка)
- [Основные функции](#основные-функции)
- [Структура проекта](#структура-проекта)
- [Основные функции в `bot.py`](#основные-функции-в-botpy)
- [Контакты](#контакты)

## Установка

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/kenisdee/TG_Bot.git
   ```

2. **Перейдите в директорию проекта:**

   ```bash
   cd TG_Bot
   ```

3. **Создайте виртуальное окружение:**

   ```bash
   python3 -m venv venv
   ```

4. **Активируйте виртуальное окружение:**

   ```bash
   source venv/bin/activate
   ```

5. **Установите зависимости:**

   ```bash
   pip3 install -r requirements.txt
   ```

6. **Настройка токена бота:**

   Создайте файл `token.txt` в любой директории.

   Поместите туда токен вашего бота, полученный от BotFather в Telegram.

   Замените `"/путь/к/файлу/token.txt"` в функции `get_token` на свой путь.

7. **Запустите бота:**

   ```bash
   python3 bot.py
   ```

## Основные функции

1. **Пикселизация изображения**: Бот уменьшает изображение до размера, кратного заданному размеру пикселя, а затем
   увеличивает его обратно до исходного размера, используя метод ближайшего соседа. Это создает эффект пикселизации.

2. **Преобразование в ASCII-арт**: Бот преобразует изображение в текст, используя набор символов, выбранный
   пользователем. Изображение сначала преобразуется в оттенки серого, затем уменьшается до нужного размера, и каждый
   пиксель заменяется соответствующим символом из набора.

3. **Инверсия цветов**: Бот инвертирует цвета изображения, превращая светлые области в темные и наоборот.

4. **Отражение изображения**: Бот может отражать изображение по горизонтали или вертикали.

5. **Создание тепловой карты**: Бот преобразует изображение в тепловую карту, используя цветовую палитру, где темные
   цвета представляют низкие значения, а светлые — высокие.

6. **Изменение размера изображения для стикера**: Бот адаптирует размер изображения для использования в качестве стикера
   в Telegram, ограничивая максимальный размер до 256 пикселей и сохраняя пропорции изображения.

7. **Отправка случайных шуток**: Бот может отправлять пользователю случайные шутки из предопределенного списка.

8. **Отправка случайных комплиментов**: Бот может отправлять пользователю случайные комплименты из предопределенного
   списка.

9. **Список команд**: Бот предоставляет список доступных команд, которые пользователь может использовать для
   взаимодействия с ботом.

## Структура проекта

- **bot.py**: Основной файл бота, содержащий логику обработки команд, фотографий и обратных вызовов.
- **lists.py**: Файл, содержащий списки случайных шуток и комплиментов для отправки пользователю.
- **help.txt**: Файл, содержащий текст справки для команды `/help`.
- **requirements.txt**: Файл, содержащий список зависимостей проекта.
- **README.md**: Файл с описанием проекта, инструкциями по установке и использованию.

## Основные функции в `bot.py`

### Импорты и настройки

- **telebot**: Используется для взаимодействия с Telegram API.
- **Pillow (PIL)**: Предоставляет инструменты для работы с изображениями.
- **TOKEN**: Строковая переменная, куда вы должны поместить токен вашего бота.
- **bot = telebot.TeleBot(TOKEN)**: Создает экземпляр бота для взаимодействия с Telegram.

### Хранение состояний пользователей

- **user_states**: Используется для отслеживания действий или состояний пользователей. Например, какое изображение было
  отправлено.

### Пикселизация

**pixelate_image(image, pixel_size)**: Принимает изображение и размер пикселя. Уменьшает изображение до размера, где
один пиксель представляет большую область, затем увеличивает обратно, создавая пиксельный эффект.

### Преобразование в ASCII-арт

**Подготовка изображения:**

- **resize_image(image, new_width=100)**: Изменяет размер изображения с сохранением пропорций.
- **grayify(image)**: Преобразует цветное изображение в оттенки серого.
- **image_to_ascii(image_stream, new_width=40)**: Основная функция для преобразования изображения в ASCII-арт. Изменяет
  размер, преобразует в градации серого и затем в строку ASCII-символов.
- **pixels_to_ascii(image)**: Конвертирует пиксели изображения в градациях серого в строку ASCII-символов, используя
  предопределенную строку ASCII_CHARS.

### Инверсия цветов

**invert_colors(image)**: Инвертирует цвета изображения с помощью функции `invert` из модуля `ImageOps`.

### Отражение изображения

**mirror_image(image, direction)**: Отражает изображение по горизонтали или вертикали в зависимости от переданного
параметра `direction`.

### Создание тепловой карты

**convert_to_heatmap(image)**: Преобразует изображение в тепловую карту, используя цветовую палитру, где темные цвета
представляют низкие значения, а светлые — высокие.

### Изменение размера изображения для стикера

**resize_for_sticker(image, max_size=256)**: Адаптирует размер изображения для использования в качестве стикера в
Telegram, ограничивая максимальный размер до 256 пикселей и сохраняя пропорции изображения.

### Отправка случайных шуток и комплиментов

**send_random_joke(message)**: Выбирает случайную шутку из списка и отправляет ее пользователю.

**send_random_compliment(message)**: Выбирает случайный комплимент из списка и отправляет его пользователю.

### Взаимодействие с пользователем

#### Обработчики сообщений

- **@bot.message_handler(commands=['start', 'help'])**: Реагирует на команды `/start` и `/help`, отправляя
  приветственное сообщение.
- **@bot.message_handler(content_types=['photo'])**: Реагирует на изображения, отправляемые пользователем, и предлагает
  варианты обработки.
- **@bot.message_handler(commands=['random_joke'])**: Реагирует на команду `/random_joke`, отправляя случайную шутку.
- **@bot.message_handler(commands=['random_compliment'])**: Реагирует на команду `/random_compliment`, отправляя
  случайный комплимент.

#### Клавиатура для взаимодействия

- **get_options_keyboard()**: Создает клавиатуру с кнопками для выбора пользователем, как обработать изображение: через
  пикселизацию, преобразование в ASCII-арт, инверсию цветов, отражение, создание тепловой карты или изменение размера
  для стикера.

### Обработка запросов

#### Обработка колбэков

- **@bot.callback_query_handler(func=lambda call: True)**: Определяет действия в ответ на выбор пользователя (например,
  пикселизация, ASCII-арт, инверсия цветов, отражение, создание тепловой карты или изменение размера для стикера) и
  вызывает соответствующую функцию обработки.

### Отправка результатов

#### Функции отправки

- **process_image(message, image_processing_func, *args)**: Обрабатывает изображение с помощью переданной функции и
  отправляет результат пользователю.
- **process_ascii_art(message)**: Преобразует изображение в ASCII-арт и отправляет результат в виде текстового
  сообщения.

## Контакты

Для связи с автором проекта, пожалуйста, используйте следующие контактные данные:

- Email: kenisdee@ya.ru
- GitHub: https://github.com/kenisdee